<html lang=en>
<title>File manager</title>
<style media=screen>
.contextMenu,.css-treeview input~ul{display:none}.css-treeview label::before,.css-treeview span::before{content:"";width:16px;margin:0 22px 0 0}#header,.contextMenu li:hover span{color:#eee}body{font-size:12px;font-family:Verdana,Arial,Sans-serif}.contextMenu{z-index:300;position:absolute;left:5px;border:1px solid #444;background-color:#f5f5f5;box-shadow:0 0 10px rgba(0,0,0,.4);font-size:11px;font-weight:700}.contextMenu ul{list-style:none;top:0;left:0;margin:0;padding:0}.contextMenu li{position:relative;min-width:60px;cursor:pointer}#editor,#header,#loading,#loading-msg,#preview,#status,#tree,.tooltip{position:absolute}.contextMenu span{color:#444;display:inline-block;padding:6px}.contextMenu li:hover{background:#444}.css-treeview li,.css-treeview ul{padding:2px 0 0;margin:0;list-style:none}.css-treeview input{position:absolute;opacity:0}.css-treeview{font-size:11px;-moz-user-select:none;-webkit-user-select:none;user-select:none}.css-treeview span{color:#00f;cursor:pointer}.css-treeview span:hover{text-decoration:underline}.css-treeview input+label+ul{margin:0 0 0 22px}.css-treeview label,.css-treeview label::before{cursor:pointer}.css-treeview input:disabled+label{cursor:default;opacity:.6}.css-treeview input:checked:not(:disabled)~ul{display:block}.css-treeview label,.css-treeview label::before,.css-treeview span{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAACgCAYAAAAFOewUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAEHElEQVRoQ+2XXWgcVRTH/7tpdrNtarqoXZe06EpTCyJiFYmKHw0UKwj2UfHBB1+KYECwUEFI8pA8SKEPiraIPlsphOIXIoJ5sFgpolRFBEke0som2Thx0+7u7M6M59y5d/bOzuw26SY0yP3ByT1z7z3/OefMzCWb8AgQv3zxGv2twas7fIl0Xx+277pT+DoDe45g154n5BWQlCNSGRcPHjqA7GBWmN2ow1pexrbb7sLdw0cDm//5IxnhEwiA8nBdD3sP5IU98PR+3HP/7bjy2w/A72cD4z06TQHCo0XXdX1zPOwY2C7ma7YDh66ZtgLcCdfxA3VjGjTPxrh+ywK0EmRQwzeHAtiYRoOzWkMGjhaohJhqna75BnTZsQeiBL4bmSONqdYc2HUWJ5H2GdAGEcSj8n2BSq2BKjXSpvnC/odx4ZOXxTwTbqIWWClXUS6tirVrFQf8ftWolNxDb4SyaGkiBdMmtvk/r2D+ryLdPYF0uhc9PT2UhXwScQKqiaoHjFV2sLLaoNS5DBfXyUa/Gw09Si0Dv4l67TaXQg20yjYqdHcWeWW5iuS2HWKdCQSSqRwW5xdDApb1LxYWS1gqLaG4sChs931H8dRLze8h+BoVf3z7uhivrZRxfecRPHn4RXHdjmYJip68b8n0DYOZSAbrJZrBOulaIFTCxMSE9NozNjYmPQkLKMbHx6UXT9z6re9BrEAikYhYO2IFqLSItePW96Dr9+B/8C0YgS1/HnT6ChWb00T9DOjqPGj149icEhSd7qww58EGCAQ94JelUCjAtu3Ii+M4DoaGhjAzMyNnmgQCffQDo1qtisk48vk8/XvnolgsyhmfoIRarSa9eFg8l8sJ01lzD4aHh1EqlZDJZJDNZuUswSUwmntDRkZGpOd5oSayy2M6nQ4ayanLLQFqr/BbBdaCvndj3wN2edRLUPAaPym1R4ZtxRJ6e3uRTCaF6ajfk/V6fYuVEAhw59eKvjdUAjM4OBj4rfDWVCqF2dnZaA9ulo3rwc3StUCkiZ2Ia1coA97QaorHDz0bfxPaJFAuHSBiVPA82/T5zzwSkbNNQgLnP//Se+75F7z3PjgjTM2z/Xjpp8DXCZXwzddfYfrcWVy88L2wubk5uQKcPPUuXj02ioOPPRMqZfMf49sTk8L6d/ZT/h723VuQKxJZSlAb9+D9Dz8WFofqhSIi0Ao/FbbJyUnv6tW/IwIdDxQ+RN88flz4v16+jOwdu/HWiRN49JGDwd5ID6ampmBZljAO5kA25p+lBaxYy8JXhDKg9wCnTr6DTP+AWKysrohRh7OYPvdpfAanT58RIwfGBTOchU5IoF1QJ7p+kdb1OeuoHpgz0QgwRsAIMEbACDBGwAgwRsAIMEbACDBGwAgwRsAIMEbACDBGAPgPluQbnYFDf0MAAAAASUVORK5CYII=) no-repeat}.css-treeview label,.css-treeview label::before,.css-treeview span,.css-treeview span::before{display:inline-block;height:16px;line-height:16px;vertical-align:middle}.css-treeview label{background-position:18px 0}.css-treeview span.txt{background-position:18px -48px}.css-treeview span.img{background-position:18px -68px}.css-treeview label::before{vertical-align:middle;background-position:0 -32px}.css-treeview input:checked+label::before{background-position:0 -16px}@media screen and (-webkit-min-device-pixel-ratio:0){.css-treeview{-webkit-animation:1s infinite webkit-adjacent-element-selector-bugfix}@-webkit-keyframes webkit-adjacent-element-selector-bugfix{from,to{padding:0}}}#header{top:0;right:0;left:0;height:24px;padding:1px 1px 0 10px;background-color:#444}#tree{top:25px;bottom:0;left:0;width:20%;padding:8px}#editor,#preview{top:25px;right:0;bottom:0;left:20%}#preview{background-color:#eee;padding:5px}#status{top:3px;right:10px;font-size:15px}#fsMeter{width:100px;padding-bottom:2px}#warning{height:100%;background-color:orange;color:#000}.tooltip{z-index:2;right:0;top:20px;visibility:hidden;background-color:#fff;color:#000;text-align:center;border:1px solid #000;padding:3px;font-size:10px}#warning:hover .tooltip{visibility:visible}#loading{top:-100vh;left:0;width:100vw;height:100vh;z-index:100;background-color:rgba(0,0,0,.5);opacity:0;transition:opacity .5s ease-in-out}#loading.shown{top:0;opacity:1}#loading-msg{display:inline-block;top:0;left:50%;transform:translateX(-50%);color:#fff;font-size:32px}@keyframes spinner-anim{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.spinner-anim:not(:required){display:inline-block;position:relative;top:50%;left:50%;transform:translate(-50%,-50%);animation:1s linear infinite spinner-anim;border:16px solid #eee;border-right-color:transparent;border-radius:32px;box-sizing:border-box;overflow:hidden;text-indent:-9999px;width:64px;height:64px}
</style>
<script>
var tree,fsInfo;const $=function(e){return document.getElementById(e)},newEm=function(e){return document.createElement(e)};function setLoading(e,t){$("loading-msg").innerHTML=t||"",e?$("loading").classList.add("shown"):$("loading").classList.remove("shown"),document.body.style.cursor=e?"wait":"default"}function readableSize(e){if(e<1024)return e+" B";for(var t=-1;t++,1024<(e/=1024););return e.toFixed(2)+[" KiB"," MiB"," GiB"," TiB","PiB"][t]}function refreshStatus(){$("status").innerHTML="(refreshing...)";var e=new XMLHttpRequest;e.onload=function(){var t,n;200!=e.status?showHttpError(e):(t=(fsInfo=JSON.parse(e.responseText)).type+" - ",fsInfo.isOk?(t+="<meter id='fsMeter' min='0' optimum='0'low='90' high='95' max='100' value='"+(1+Math.round(99*fsInfo.usedBytes/fsInfo.totalBytes))+"' title='"+(n=readableSize(fsInfo.totalBytes-fsInfo.usedBytes)+" free of "+readableSize(fsInfo.totalBytes))+"'>"+n+"</meter>",fsInfo.unsupportedFiles&&(t+=" <span id='warning'>WARNING<span class='tooltip'>Filesystem contains unsupported filenames:<br/>"+fsInfo.unsupportedFiles+"</span></span>")):t+="<span style='background-color:red;color:white;font-weight:bold'>INIT ERROR !</span>",$("status").innerHTML=t,"SPIFFS"!=fsInfo.type&&($("mkdir").style.display="inline"))},e.open("GET","/status",!0),e.send(null)}function showHttpError(e){alert("ERROR: ["+e.status+"] "+e.responseText)}function canLoadNewContents(){return!!$("saveBtn").disabled||!!confirm("Changes to your document will be lost if you continue")&&(enableSaveDiscardBtns(!1),!0)}function enableSaveDiscardBtns(e){$("saveBtn").disabled=!e,$("discardBtn").disabled=!e}function getParentFolder(e){return(e=(e=e.startsWith("/")?e:"/"+e).endsWith("/")?e.slice(0,-1):e).substring(0,e.lastIndexOf("/"))}function createHeader(e,t,n){var a=$(e),o=newEm("input");o.type="file",o.multiple=!1,o.name="data",a.appendChild(o);var i=newEm("input");i.id="pathInput",i.type="text",i.name="path",i.defaultValue="/",a.appendChild(i);var s=newEm("button");s.innerHTML="Upload",a.appendChild(s);var l=newEm("button");l.id="mkdir",l.style.display="none",l.innerHTML="MkDir",a.appendChild(l);var d=newEm("button");d.innerHTML="MkFile",a.appendChild(d);var r=newEm("span");r.id="editorButtons",r.style.display="none",a.appendChild(r);var c=newEm("button");c.id="saveBtn",c.innerHTML="Save",c.style.marginLeft="30px",c.disabled=!0,r.appendChild(c);var p=newEm("button");p.id="discardBtn",p.innerHTML="Discard",p.disabled=!0,r.appendChild(p),(e=newEm("button")).id="helpBtn",e.innerHTML="?",r.appendChild(e),(r=newEm("span")).id="status",r.innerHTML="(loading)",a.appendChild(r),o.onchange=function(e){var t;0!==o.files.length&&(t=o.files[0].name,i.value.startsWith("/")||(i.value="/"+i.value),i.value=getParentFolder(i.value)+"/"+t)},s.onclick=function(e){0!==o.files.length&&t.httpUpload(o.files[0],i.value)},d.onclick=function(e){var n=i.value.trim();""===n?alert("A filename must be given"):n.endsWith("/")?alert("Filenames must not end with a '/' character"):t.httpCreate(n)},l.onclick=function(e){var n=i.value.trim();""===n?alert("A folder name must be given"):(n.endsWith("/")||(n+="/"),t.httpCreate(n))},c.onclick=function(e){n.save()},p.onclick=function(e){n.discard()},e.onclick=function(e){n.showShortcuts()}}function createTree(e,t){var n=$("preview"),a=newEm("div");function o(e){const t=e.split(".").pop().toLowerCase();return["txt","htm","html","js","json","cpp","css","xml","yaml","csv"].includes(t)||t===e}function i(e){if(void 0!==(e=/(?:\.([^.]+))?$/.exec(e)[1]))switch(e.toLowerCase()){case"png":case"jpg":case"jpeg":case"gif":case"ico":return 1}}function s(e,t){var n=newEm("ul");e.appendChild(n);var a=newEm("li");n.appendChild(a),a=newEm("li"),n.appendChild(a),a.innerHTML="<span>Rename/Move</span>",a.onclick=function(n){0<document.body.getElementsByClassName("contextMenu").length&&document.body.removeChild(e);var a=prompt("Rename "+t+" to",t);null!=a&&a!=t&&p(t,a)},a=newEm("li"),n.appendChild(a),a.innerHTML="<span>Delete</span>",a.onclick=function(n){0<document.body.getElementsByClassName("contextMenu").length&&document.body.removeChild(e),u(t)}}function l(e,t,n){var a=newEm("div"),o=document.body.scrollTop||document.documentElement.scrollTop,i=document.body.scrollLeft||document.documentElement.scrollLeft,l=e.clientX+i,d=e.clientY+o;a.className="contextMenu",a.style.display="block",a.style.left=l+"px",a.style.top=d+"px",(n?s:function(e,t){var n=newEm("ul");e.appendChild(n);var a=newEm("li");n.appendChild(a);var o=$(t).childNodes[0].checked;a=newEm("li");n.appendChild(a),o?(a.innerHTML="<span>Collapse</span>",a.onclick=function(n){0<document.body.getElementsByClassName("contextMenu").length&&document.body.removeChild(e),$(t).childNodes[0].checked=!1},o=newEm("li"),n.appendChild(o),o.innerHTML="<span>Refresh</span>",o.onclick=function(n){0<document.body.getElementsByClassName("contextMenu").length&&document.body.removeChild(e),r(t,n)}):(a.innerHTML="<span>Expand</span>",a.onclick=function(n){0<document.body.getElementsByClassName("contextMenu").length&&document.body.removeChild(e),$(t).childNodes[0].checked=!0,r(t,n)}),a=newEm("li"),n.appendChild(a),a.innerHTML="<span>Rename/Move</span>",a.onclick=function(n){0<document.body.getElementsByClassName("contextMenu").length&&document.body.removeChild(e);var a=prompt("Rename "+t+" to",t);null!=a&&a!=t&&p(t,a)},a=newEm("li"),n.appendChild(a),a.innerHTML="<span>Delete</span>",a.onclick=function(n){0<document.body.getElementsByClassName("contextMenu").length&&document.body.removeChild(e),u(t)}})(a,t),document.body.appendChild(a);var c=a.offsetWidth,m=a.offsetHeight;a.onmouseout=function(e){(e.clientX<l||e.clientX>l+c||e.clientY<d||e.clientY>d+m)&&0<document.body.getElementsByClassName("contextMenu").length&&document.body.removeChild(a)}}function d(e,t){return function(){var n;setLoading(!1),200!=e.status?showHttpError(e):t?(n=getParentFolder(t),e.responseText&&e.responseText!=n&&refreshPath(e.responseText),refreshPath(n),attemptLoad(t)):refreshPath(e.responseText),refreshStatus()}}function r(e,t){var n,a,s;setLoading(!0,"Listing '"+e+"'..."),xmlHttp=new XMLHttpRequest,xmlHttp.onload=(n=xmlHttp,a=e,s=t,function(){var e,t;setLoading(!1),200!=n.status?showHttpError(n):(!(e=$(a))||(t=e.lastElementChild)&&"UL"==t.tagName&&e.removeChild(t),function(e,t){t.sort((function(e,t){return e.type==t.type?e.name.localeCompare(t.name):e.type.localeCompare(t.type)}));var n=newEm("ul");$(e).appendChild(n);for(var a=t.length,s=0;s<a;s++){var d="file"===(d=t[s]).type?function(e,t,n){var a=newEm("li");return a.id=("/"==e?"":e)+"/"+t,e=newEm("span"),o(t)?e.classList.add("txt"):i(t)&&e.classList.add("img"),e.innerHTML=t+" <i>("+readableSize(n)+")</i>",a.appendChild(e),a.onclick=function(e){attemptLoad(a.id)},a.oncontextmenu=function(e){e.preventDefault(),e.stopPropagation(),l(e,a.id,!0)},a}(e,d.name,d.size):function(e,t,n){var a=newEm("li");a.id=("/"==e?"":e)+"/"+t;var o=newEm("input");return o.type="checkbox",void 0!==n&&n&&(o.disabled="disabled"),a.appendChild(o),(n=newEm("label")).textContent=t,a.appendChild(n),o.onchange=function(e){o.checked&&r(a.id)},n.onclick=function(e){o.checked?o.checked=!1:(o.checked=!0,r(a.id))},a.oncontextmenu=function(e){e.preventDefault(),e.stopPropagation(),l(e,a.id,!1)},a}(e,d.name);n.appendChild(d)}$("pathInput").value=e}(a,JSON.parse(n.responseText)),void 0!==$(a).childNodes[0].checked&&($(a).childNodes[0].checked=!0),s&&s.length&&c(s))}),xmlHttp.open("GET","/list?dir="+e,!0),xmlHttp.send(null)}function c(e){var t=e.pop();t&&r(t,e)}function p(e,t){setLoading(!0,"Renaming '"+e+"' to '"+t+"'..."),t.startsWith("/")||(t="/"+t),xmlHttp=new XMLHttpRequest,xmlHttp.onload=d(xmlHttp,t);var n=new FormData;n.append("path",t),n.append("src",e),xmlHttp.open("PUT","/edit"),xmlHttp.send(n)}function u(e){setLoading(!0,"Deleting '"+e+"'..."),xmlHttp=new XMLHttpRequest,xmlHttp.onload=d(xmlHttp,e);var t=new FormData;t.append("path",e),xmlHttp.open("DELETE","/edit"),xmlHttp.send(t)}return a.className="css-treeview",a.id="/",$(e).appendChild(a),this.clearMainPanel=function(){$("editor").style.display="none",$("editorButtons").style.display="none",n.style.display="block",n.innerHTML="<div style='text-align:center'>(file not found or format not supported)</div>"},this.attemptLoad=function(e){$("pathInput").value=e,canLoadNewContents()&&(o(e)?"undefined"==typeof ace?function(e){$("pathInput").value=e,$("editor").style.display="none",$("editorButtons").style.display="none",n.style.display="block",n.innerHTML="<span style='color:red;'>Ace editor could not be loaded from the internet nor from /edit/ace.js . Defaulting to text viewer...</span><pre id='txtContents' style='overflow: auto;'></pre>";var t=new XMLHttpRequest;t.onload=function(){$("txtContents").textContent=this.responseText},t.open("GET",e),t.send()}(e):t.loadUrl(e):i(e)?function(e){$("pathInput").value=e,$("editor").style.display="none",$("editorButtons").style.display="none",n.style.display="block",n.innerHTML="<img src='"+e+"' style='max-width:100%; max-height:100%; margin:auto; display:block;' />"}(e):clearMainPanel())},this.refreshPath=function(e){if("SPIFFS"==fsInfo.type)r("/");else if(-1==e.lastIndexOf("/"))r("/");else{for(var t=[],n=e;-1!=n.lastIndexOf("/")&&!$(n);)t.push(n),n=getParentFolder(n);""==n?t.push("/"):t.push(n),c(t)}},this.httpUpload=function(e,t){setLoading(!0,"Uploading '"+t+"'..."),t.startsWith("/")||(t="/"+t),xmlHttp=new XMLHttpRequest,xmlHttp.onload=d(xmlHttp,t);var n=new FormData;n.append("data",e,t),xmlHttp.open("POST","/edit"),xmlHttp.send(n)},this.httpCreate=function(e){setLoading(!0,"Creating '"+e+"'..."),e.startsWith("/")||(e="/"+e),xmlHttp=new XMLHttpRequest,xmlHttp.onload=d(xmlHttp,e);var t=new FormData;t.append("path",e),xmlHttp.open("PUT","/edit"),xmlHttp.send(t)},r("/"),this}function createEditor(e,t,n,a,o){function i(e){var t="plain",n=/(?:\.([^.]+))?$/.exec(e)[1];if(void 0!==n)switch(n){case"txt":t="plain";break;case"htm":t="html";break;case"js":t="javascript";break;case"css":case"scss":case"php":case"html":case"json":case"xml":case"yaml":case"csv":t=n}return t}void 0===t&&(t="/index.htm"),void 0===n&&(n=i(t)),void 0===a&&(a="textmate"),void 0===o&&(o="c_cpp"===n?"text/plain":"text/"+n);var s=null,l=ace.edit(e);function d(){setLoading(!1),200!=s.status&&showHttpError(s),tree.refreshPath(getParentFolder(t)),refreshStatus()}function r(){setLoading(!1),$("preview").style.display="none",$("editor").style.display="block",$("editorButtons").style.display="inline",200==s.status?(l.setValue(s.responseText),l.clearSelection(),enableSaveDiscardBtns(!1)):tree.clearMainPanel()}function c(e){setLoading(!0,"Loading '"+e+"'..."),(s=new XMLHttpRequest).onload=r,s.open("GET",e,!0),s.send(null)}return"plain"!==n&&l.getSession().setMode("ace/mode/"+n),l.setTheme("ace/theme/"+a),l.$blockScrolling=1/0,l.getSession().setUseSoftTabs(!0),l.getSession().setTabSize(2),l.setHighlightActiveLine(!0),l.setShowPrintMargin(!1),l.commands.addCommand({name:"save",bindKey:{win:"Ctrl-S",mac:"Command-S"},exec:function(e){e.save()},readOnly:!1}),l.commands.addCommand({name:"showKeyboardShortcuts",bindKey:{win:"Ctrl-Alt-h",mac:"Command-Alt-h"},exec:function(e){e.showShortcuts()}}),l.session.on("change",(function(e){enableSaveDiscardBtns(!0)})),l.loadUrl=function(e){$("pathInput").value=e,enableSaveDiscardBtns(!1),n=i(t=e),o="text/"+n,"plain"!==n&&l.getSession().setMode("ace/mode/"+n),c(t)},l.save=function(){enableSaveDiscardBtns(!1),function(e,t,n){setLoading(!0,"Saving '"+e+"'..."),(s=new XMLHttpRequest).onload=d;var a=new FormData;a.append("data",new Blob([t],{type:n}),e),s.open("POST","/edit"),s.send(a)}(t,l.getValue()+"",o)},l.discard=function(){l.loadUrl(t),enableSaveDiscardBtns(!1)},l.showShortcuts=function(){ace.config.loadModule("ace/ext/keybinding_menu",(function(e){e.init(l),l.showKeyboardShortcuts()}))},c(t),l}function onBodyLoad(){var e,t={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(e,n,a){t[n]=a})),"undefined"!=typeof ace&&(e=createEditor("editor",t.file,t.lang,t.theme)),createHeader("header",tree=createTree("tree",e),e),refreshStatus()}
</script>
<script src="https://cdn.jsdelivr.net/npm/ace-builds@1.28.0/src-min-noconflict/ace.min.js"></script>
<script>var script;"undefined"==typeof ace&&(console.log("Cannot load ace.js from the web, trying local copy"),(script=newEm("script")).src="/edit/ace.js",script.async=!1,document.head.appendChild(script))</script>
<body onload=onBodyLoad()>
<div id=header></div>
<div id=tree></div>
<div id=editor></div>
<div id=preview style=display:none></div>
<div id=loading><span id=loading-msg></span>
<br>
<div class=spinner-anim>Loading...</div>
</div>
</body>
</html>